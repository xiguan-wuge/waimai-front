import{u as z}from"./userRouterHook-d892abf0.js";import{H as D,I as $}from"./Header-6db2049e.js";import{u as R,S as U,c as j,s as p,a as A,b as L}from"./ShopCart-675d56e8.js";import{d as G,r as m,c as f,w as J,o as c,a as r,b as t,e as h,F as v,f as k,n as M,t as l,g as P,u as Q,p as W,h as X,i as b,_ as Y}from"./index-5c713276.js";const g=d=>(W("data-v-41477b35"),d=d(),X(),d),Z={class:"home"},T={class:"nav"},ee=g(()=>t("p",{class:"nav-title flex-center"},"订餐需知",-1)),te={class:"nav-list"},oe=["onClick"],se=g(()=>t("p",null,"意见反馈",-1)),ae={class:"content"},ne={class:"food-title"},ce=["onClick"],re={class:"food-img flex-center"},ie=["src"],le=g(()=>t("div",{class:"img-error"},"暂无图片",-1)),ue={class:"food-right"},de={class:"food-name"},he={class:"food-other"},_e={class:"food-price"},pe={class:"shopping-cart"},me=G({__name:"Home",setup(d){const y=m("hot"),F=m([{name:"热销",key:"hot"},{name:"特卖",key:"special"},{name:"星期一",key:"1"},{name:"星期二",key:"2"},{name:"星期三",key:"3"},{name:"星期四",key:"4"},{name:"星期五",key:"5"},{name:"星期六",key:"6"},{name:"星期七",key:"7"}]);function x(e){y.value=e}const u=m([]),i=R(),H=f(()=>i.cartList),C=f(()=>i.currentFoodKey),E=f(()=>i.currentFoodCount);J(H,e=>{if(e.length){if(C.value==="all"){u.value.forEach(n=>{n.list.forEach(a=>{e.forEach(o=>{a.key===o.key&&L(a,o[p]||0)})})}),i.refreshCurKey();return}u.value.forEach(n=>{n.list.forEach(a=>{a.key===C.value&&L(a,E.value)})})}else u.value.forEach(n=>{n.list.forEach(a=>{a[p]=0})})},{deep:!0});function I(e,n){i.changeCount(e,n)}function w(){return b.get("getFoodList").then(e=>{console.log("res---",e),e&&e.code===0&&(u.value=e.data)}).catch(e=>{console.log("err--",e)})}function K(){return b.get("getShopcartList").then(e=>{console.log("getShopcartList-res",e),i.setCartList(e.data)}).catch(e=>{console.log("getShopcartList-err",e)})}async function N(){try{await w(),await K()}catch(e){console.log("initHome-err",e)}}N();const{router:_}=z();function B(e){_.push({path:"/detail",query:{foodKey:e.key}})}function O(){_.push({path:"/feedback",query:{title:"意见反馈",type:"feedback"}})}function V(e){_.push({path:"/order"}),e===1&&j(2)}return(e,n)=>{const a=$;return c(),r("div",Z,[t("header",null,[h(D,{title:"菜品订购",rightIcon:"Order"})]),t("main",null,[t("aside",T,[ee,t("ul",te,[(c(!0),r(v,null,k(F.value,o=>(c(),r("li",{class:M(["nav-item flex-center",{"nav-item-active":o.key===y.value}]),onClick:s=>x(o.key),key:o.key},l(o.name),11,oe))),128))]),t("div",{class:"nav-feedback",onClick:O},[h(a,{name:"chat-o",color:"#F19029",size:"20"}),se])]),t("div",ae,[(c(!0),r(v,null,k(u.value,o=>(c(),r("div",{class:"food",key:o.key},[t("p",ne,l(o.title),1),(c(!0),r(v,null,k(o.list,(s,q)=>(c(),r("div",{class:"food-detail van-hairline--bottom",key:q,onClick:S=>B(s)},[t("div",re,[s.img?(c(),r("img",{key:0,src:s.img,alt:""},null,8,ie)):P("",!0),le]),t("div",ue,[t("p",de,l(s.name),1),t("p",he," 剩余"+l(s.count)+"    点赞"+l(s.praise),1),t("p",_e,"￥"+l(s.price),1),h(A,{"model-value":s[Q(p)],onChange:S=>I(s,S),max:s.count,class:"stepper"},null,8,["model-value","onChange","max"])])],8,ce))),128))]))),128))])]),t("footer",pe,[h(U,{onHandle:V})])])}}});const ye=Y(me,[["__scopeId","data-v-41477b35"]]);export{ye as default};
